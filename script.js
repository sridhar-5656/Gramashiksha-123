// Language translations
const translations = {
    en: {
        'site-name': 'Gramshiksha',
        'nav-home': 'Home',
        'nav-education': 'Education',
        'nav-signature': 'Audio Signature',
        'nav-awareness': 'Cyber Awareness',
        'nav-contact': 'Contact',
        'nav-interest':'Interest',
        'login': 'Login',
        'signup': 'Sign Up',
        'hero-title': 'Welcome to Gramshiksha',
        'hero-subtitle': 'Quality Education for Rural Communities',
        'hero-description': 'Access free educational content, learn new skills, and stay aware of cyber security in your local language.',
        'start-learning': 'Start Learning',
        'create-signature': 'Create Audio Signature',
        'education-title': 'Educational Resources',
        'education-subtitle': 'Learn at your own pace with our comprehensive video library',
        'subject-english': 'English',
        'subject-english-desc': 'Basic English communication and grammar',
        'subject-telugu': 'Telugu',
        'subject-telugu-desc': 'Telugu literature and language skills',
        'subject-science': 'Science',
        'subject-science-desc': 'Basic science concepts and experiments',
        'subject-gk': 'General Knowledge',
        'subject-gk-desc': 'Current affairs and general awareness',
        'signature-title': 'Audio Signature Generator',
        'signature-subtitle': 'Create your unique audio signature for authentication',
        'click-to-record': 'Click microphone to start recording',
        'start-recording': 'Start Recording',
        'stop-recording': 'Stop Recording',
        'play-recording': 'Play Recording',
        'download-signature': 'Download Signature',
        'awareness-title': 'Cyber Crime Awareness',
        'awareness-subtitle': 'Stay safe online with these important tips and resources',
        'awareness-videos-title': 'Educational Videos',
        'video1-title': 'Internet Safety Basics',
        'video1-desc': 'Learn fundamental internet safety practices',
        'video2-title': 'Password Security',
        'video2-desc': 'How to create and manage secure passwords',
        'emergency-title': 'Emergency Contacts',
        'cyber-helpline': 'Cyber Crime Helpline',
        'police-helpline': 'Police Helpline',
        'emergency-helpline': 'Emergency Services',
        'contact-title': 'Contact Us',
        'email': 'Email',
        'phone': 'Phone',
        'address': 'Address',
        'address-text': 'Rural Education Center, India',
        'send-message': 'Send Message',
        'footer-desc': 'Empowering rural communities through digital education',
        'quick-links': 'Quick Links',
        'follow-us': 'Follow Us',
        'rights-reserved': 'All rights reserved.',
        'no-account': "Don't have an account?",
        'have-account': 'Already have an account?',
        'name-placeholder': 'Your Name',
        'email-placeholder': 'Your Email',
        'password-placeholder': 'Password',
        'confirm-password-placeholder': 'Confirm Password',
        'message-placeholder': 'Your Message'
    },
    te: {
        'site-name': 'గ్రామశిక్ష',
        'nav-home': 'హోమ్',
        'nav-education': 'విద్య',
        'nav-signature': 'ఆడియో సిగ్నేచర్',
        'nav-awareness': 'సైబర్ అవగాహన',
        'nav-contact': 'సంప్రదింపులు',
        'nav-interest':'వడ్డీ ',
        'login': 'లాగిన్',
        'signup': 'సైన్ అప్',
        'hero-title': 'గ్రామశిక్షకు స్వాగతం',
        'hero-subtitle': 'గ్రామీణ సమాజాలకు నాణ్యమైన విద్య',
        'hero-description': 'ఉచిత విద్యా కంటెంట్‌ను యాక్సెస్ చేయండి, కొత్త నైపుణ్యాలను నేర్చుకోండి మరియు మీ స్థానిక భాషలో సైబర్ భద్రతా గురించి తెలుసుకోండి.',
        'start-learning': 'నేర్చుకోవడం ప్రారంభించండి',
        'create-signature': 'ఆడియో సిగ్నేచర్ సృష్టించండి',
        'education-title': 'విద్యా వనరులు',
        'education-subtitle': 'మా సమగ్ర వీడియో లైబ్రరీతో మీ స్వంత వేగంతో నేర్చుకోండి',
        'subject-english': 'ఇంగ్లీష్',
        'subject-english-desc': 'ప్రాథమిక ఇంగ్లీష్ కమ్యూనికేషన్ మరియు వ్యాకరణం',
        'subject-telugu': 'తెలుగు',
        'subject-telugu-desc': 'తెలుగు సాహిత్యం మరియు భాషా నైపుణ్యాలు',
        'subject-science': 'సైన్స్',
        'subject-science-desc': 'ప్రాథమిక సైన్స్ కాన్సెప్ట్‌లు మరియు ప్రయోగాలు',
        'subject-gk': 'సాధారణ జ్ఞానం',
        'subject-gk-desc': 'ప్రస్తుత వ్యవహారాలు మరియు సాధారణ అవగాహన',
        'signature-title': 'ఆడియో సిగ్నేచర్ జనరేటర్',
        'signature-subtitle': 'ప్రమాణీకరణ కోసం మీ ప్రత్యేక ఆడియో సిగ్నేచర్‌ను సృష్టించండి',
        'click-to-record': 'రికార్డింగ్ ప్రారంభించడానికి మైక్రోఫోన్‌ను క్లిక్ చేయండి',
        'start-recording': 'రికార్డింగ్ ప్రారంభించండి',
        'stop-recording': 'రికార్డింగ్ ఆపండి',
        'play-recording': 'రికార్డింగ్ ప్లే చేయండి',
        'download-signature': 'సిగ్నేచర్ డౌన్‌లోడ్ చేయండి',
        'awareness-title': 'సైబర్ క్రైమ్ అవగాహన',
        'awareness-subtitle': 'ఈ ముఖ్యమైన చిట్కాలు మరియు వనరులతో ఆన్‌లైన్‌లో సురక్షితంగా ఉండండి',
        'awareness-videos-title': 'విద్యా వీడియోలు',
        'video1-title': 'ఇంటర్నెట్ భద్రత బేసిక్స్',
        'video1-desc': 'ప్రాథమిక ఇంటర్నెట్ భద్రతా పద్ధతులను నేర్చుకోండి',
        'video2-title': 'పాస్‌వర్డ్ భద్రత',
        'video2-desc': 'సురక్షిత పాస్‌వర్డ్‌లను ఎలా సృష్టించాలి మరియు నిర్వహించాలి',
        'emergency-title': 'అత్యవసర సంప్రదింపులు',
        'cyber-helpline': 'సైబర్ క్రైమ్ హెల్ప్‌లైన్',
        'police-helpline': 'పోలీస్ హెల్ప్‌లైన్',
        'emergency-helpline': 'అత్యవసర సేవలు',
        'contact-title': 'మమ్మల్ని సంప్రదించండి',
        'email': 'ఇమెయిల్',
        'phone': 'ఫోన్',
        'address': 'చిరునామా',
        'address-text': 'రూరల్ ఎడ్యుకేషన్ సెంటర్, ఇండియా',
        'send-message': 'సందేశం పంపండి',
        'footer-desc': 'డిజిటల్ విద్య ద్వారా గ్రామీణ సమాజాలను శక్తివంతం చేయడం',
        'quick-links': 'శీఘ్ర లింకులు',
        'follow-us': 'మమ్మల్ని అనుసరించండి',
        'rights-reserved': 'అన్ని హక్కులు భద్రపరచబడ్డాయి.',
        'no-account': 'ఖాతా లేదా?',
        'have-account': 'ఇప్పటికే ఖాతా ఉందా?',
        'name-placeholder': 'మీ పేరు',
        'email-placeholder': 'మీ ఇమెయిల్',
        'password-placeholder': 'పాస్‌వర్డ్',
        'confirm-password-placeholder': 'పాస్‌వర్డ్ నిర్ధారించండి',
        'message-placeholder': 'మీ సందేశం'
    },
    hi: {
        'site-name': 'ग्रामशिक्षा',
        'nav-home': 'होम',
        'nav-education': 'शिक्षा',
        'nav-signature': 'ऑडियो साइन',
        'nav-awareness': 'साइबर जागरूकता',
        'nav-contact': 'संपर्क',
        'nav-interest':'ब्याज',
        'login': 'लॉगिन',
        'signup': 'साइन अप',
        'hero-title': 'ग्रामशिक्षा में आपका स्वागत है',
        'hero-subtitle': 'ग्रामीण समुदायों के लिए गुणवत्तापूर्ण शिक्षा',
        'hero-description': 'मुफ्त शैक्षिक सामग्री तक पहुंचें, नए कौशल सीखें, और अपनी स्थानीय भाषा में साइबर सुरक्षा के बारे में जागरूक रहें।',
        'start-learning': 'सीखना शुरू करें',
        'create-signature': 'ऑडियो साइन बनाएं',
        'education-title': 'शैक्षिक संसाधन',
        'education-subtitle': 'हमारी व्यापक वीडियो लाइब्रेरी के साथ अपनी गति से सीखें',
        'subject-english': 'अंग्रेजी',
        'subject-english-desc': 'बुनियादी अंग्रेजी संचार और व्याकरण',
        'subject-telugu': 'तेलुगु',
        'subject-telugu-desc': 'तेलुगु साहित्य और भाषा कौशल',
        'subject-science': 'विज्ञान',
        'subject-science-desc': 'बुनियादी विज्ञान अवधारणाएं और प्रयोग',
        'subject-gk': 'सामान्य ज्ञान',
        'subject-gk-desc': 'समसामयिक घटनाएं और सामान्य जागरूकता',
        'signature-title': 'ऑडियो साइन जेनरेटर',
        'signature-subtitle': 'प्रमाणीकरण के लिए अपना अनूठा ऑडियो साइन बनाएं',
        'click-to-record': 'रिकॉर्डिंग शुरू करने के लिए माइक्रोफोन पर क्लिक करें',
        'start-recording': 'रिकॉर्डिंग शुरू करें',
        'stop-recording': 'रिकॉर्डिंग रोकें',
        'play-recording': 'रिकॉर्डिंग चलाएं',
        'download-signature': 'साइन डाउनलोड करें',
        'awareness-title': 'साइबर अपराध जागरूकता',
        'awareness-subtitle': 'इन महत्वपूर्ण सुझावों और संसाधनों के साथ ऑनलाइन सुरक्षित रहें',
        'awareness-videos-title': 'शैक्षिक वीडियो',
        'video1-title': 'इंटरनेट सुरक्षा मूल बातें',
        'video1-desc': 'बुनियादी इंटरनेट सुरक्षा प्रथाओं को सीखें',
        'video2-title': 'पासवर्ड सुरक्षा',
        'video2-desc': 'सुरक्षित पासवर्ड कैसे बनाएं और प्रबंधित करें',
        'emergency-title': 'आपातकालीन संपर्क',
        'cyber-helpline': 'साइबर क्राइम हेल्पलाइन',
        'police-helpline': 'पुलिस हेल्पलाइन',
        'emergency-helpline': 'आपातकालीन सेवाएं',
        'contact-title': 'हमसे संपर्क करें',
        'email': 'ईमेल',
        'phone': 'फोन',
        'address': 'पता',
        'address-text': 'ग्रामीण शिक्षा केंद्र, भारत',
        'send-message': 'संदेश भेजें',
        'footer-desc': 'डिजिटल शिक्षा के माध्यम से ग्रामीण समुदायों को सशक्त बनाना',
        'quick-links': 'त्वरित लिंक',
        'follow-us': 'हमें फॉलो करें',
        'rights-reserved': 'सभी अधिकार सुरक्षित।',
        'no-account': 'खाता नहीं है?',
        'have-account': 'पहले से खाता है?',
        'name-placeholder': 'आपका नाम',
        'email-placeholder': 'आपका ईमेल',
        'password-placeholder': 'पासवर्ड',
        'confirm-password-placeholder': 'पासवर्ड की पुष्टि करें',
        'message-placeholder': 'आपका संदेश'
    }
};

// Subject content data
const subjectContent = {
    english: {
        en: {
            title: 'English Learning',
            videos: [
                {
                    id: 'YQHsXMglC9A',
                    title: 'Basic English Grammar',
                    description: 'Learn the fundamentals of English grammar including nouns, verbs, and sentence structure.'
                },
                {
                    id: 'VqmGiUs7CwM',
                    title: 'English Speaking Practice',
                    description: 'Practice everyday English conversation and improve your speaking skills.'
                },
                {
                    id: '3lB0P7aKf5Q',
                    title: 'English Vocabulary Building',
                    description: 'Expand your English vocabulary with common words and phrases.'
                }
            ]
        },
        te: {
            title: 'ఇంగ్లీష్ నేర్చుకోవడం',
            videos: [
                {
                    id: 'YQHsXMglC9A',
                    title: 'ప్రాథమిక ఇంగ్లీష్ వ్యాకరణం',
                    description: 'నామవాచకాలు, క్రియలు మరియు వాక్య నిర్మాణంతో సహా ఇంగ్లీష్ వ్యాకరణ ప్రాథమికాలను నేర్చుకోండి.'
                },
                {
                    id: 'VqmGiUs7CwM',
                    title: 'ఇంగ్లీష్ మాట్లాడే అభ్యాసం',
                    description: 'రోజువారీ ఇంగ్లీష్ సంభాషణను అభ్యసించండి మరియు మీ మాట్లాడే నైపుణ్యాలను మెరుగుపరచుకోండి.'
                },
                {
                    id: '3lB0P7aKf5Q',
                    title: 'ఇంగ్లీష్ పదజాలం నిర్మాణం',
                    description: 'సాధారణ పదాలు మరియు పదబంధాలతో మీ ఇంగ్లీష్ పదజాలాన్ని విస్తరించండి.'
                }
            ]
        },
        hi: {
            title: 'अंग्रेजी सीखना',
            videos: [
                {
                    id: 'YQHsXMglC9A',
                    title: 'बुनियादी अंग्रेजी व्याकरण',
                    description: 'संज्ञा, क्रिया और वाक्य संरचना सहित अंग्रेजी व्याकरण की मूल बातें सीखें।'
                },
                {
                    id: 'VqmGiUs7CwM',
                    title: 'अंग्रेजी बोलने का अभ्यास',
                    description: 'रोजमर्रा की अंग्रेजी बातचीत का अभ्यास करें और अपने बोलने के कौशल में सुधार करें।'
                },
                {
                    id: '3lB0P7aKf5Q',
                    title: 'अंग्रेजी शब्दावली निर्माण',
                    description: 'सामान्य शब्दों और वाक्यांशों के साथ अपनी अंग्रेजी शब्दावली का विस्तार करें।'
                }
            ]
        }
    },
    telugu: {
        en: {
            title: 'Telugu Learning',
            videos: [
                {
                    id: 'I-FuaDaGWX4',
                    title: 'Telugu Alphabet',
                    description: 'Learn the Telugu script and alphabet with proper pronunciation.'
                },
                {
                    id: 'rNzLFKM8x64',
                    title: 'Telugu Grammar Basics',
                    description: 'Understand the basic grammar rules of Telugu language.'
                },
                {
                    id: 'wfGKzZdGYv8',
                    title: 'Telugu Literature',
                    description: 'Explore the rich heritage of Telugu literature and poetry.'
                }
            ]
        },
        te: {
            title: 'తెలుగు నేర్చుకోవడం',
            videos: [
                {
                    id: 'I-FuaDaGWX4',
                    title: 'తెలుగు వర్ణమాల',
                    description: 'సరైన ఉచ్చారణతో తెలుగు లిపి మరియు వర్ణమాలను నేర్చుకోండి.'
                },
                {
                    id: 'rNzLFKM8x64',
                    title: 'తెలుగు వ్యాకరణ ప్రాథమికాలు',
                    description: 'తెలుగు భాష యొక్క ప్రాథమిక వ్యాకరణ నియమాలను అర్థం చేసుకోండి.'
                },
                {
                    id: 'wfGKzZdGYv8',
                    title: 'తెలుగు సాహిత్యం',
                    description: 'తెలుగు సాహిత్యం మరియు కవిత్వం యొక్క గొప్ప వారసత్వాన్ని అన్వేషించండి.'
                }
            ]
        },
        hi: {
            title: 'तेलुगु सीखना',
            videos: [
                {
                    id: 'I-FuaDaGWX4',
                    title: 'तेलुगु वर्णमाला',
                    description: 'उचित उच्चारण के साथ तेलुगु लिपि और वर्णमाला सीखें।'
                },
                {
                    id: 'rNzLFKM8x64',
                    title: 'तेलुगु व्याकरण मूल बातें',
                    description: 'तेलुगु भाषा के बुनियादी व्याकरण नियमों को समझें।'
                },
                {
                    id: 'wfGKzZdGYv8',
                    title: 'तेलुगु साहित्य',
                    description: 'तेलुगु साहित्य और कविता की समृद्ध विरासत का अन्वेषण करें।'
                }
            ]
        }
    },
    science: {
        en: {
            title: 'Science Learning',
            videos: [
                {
                    id: 'QnQe0xW_JY4',
                    title: 'Basic Physics Concepts',
                    description: 'Understand fundamental physics concepts like motion, force, and energy.'
                },
                {
                    id: 'HQBY9mCWvEU',
                    title: 'Chemistry for Beginners',
                    description: 'Learn basic chemistry concepts including atoms, molecules, and reactions.'
                },
                {
                    id: 'iKOqIDcy4UE',
                    title: 'Biology Basics',
                    description: 'Explore the fundamentals of biology including cells, plants, and animals.'
                }
            ]
        },
        te: {
            title: 'సైన్స్ నేర్చుకోవడం',
            videos: [
                {
                    id: 'QnQe0xW_JY4',
                    title: 'ప్రాథమిక భౌతిక శాస్త్ర భావనలు',
                    description: 'చలనం, బలం మరియు శక్తి వంటి ప్రాథమిక భౌతిక శాస్త్ర భావనలను అర్థం చేసుకోండి.'
                },
                {
                    id: 'HQBY9mCWvEU',
                    title: 'ప్రారంభకులకు రసాయన శాస్త్రం',
                    description: 'అణువులు, అణువులు మరియు ప్రతిచర్యలతో సహా ప్రాథమిక రసాయన శాస్త్ర భావనలను నేర్చుకోండి.'
                },
                {
                    id: 'iKOqIDcy4UE',
                    title: 'జీవ శాస్త్ర ప్రాథమికాలు',
                    description: 'కణాలు, మొక్కలు మరియు జంతువులతో సహా జీవ శాస్త్రం యొక్క ప్రాథమికాలను అన్వేషించండి.'
                }
            ]
        },
        hi: {
            title: 'विज्ञान सीखना',
            videos: [
                {
                    id: 'QnQe0xW_JY4',
                    title: 'बुनियादी भौतिकी अवधारणाएं',
                    description: 'गति, बल और ऊर्जा जैसी मौलिक भौतिकी अवधारणाओं को समझें।'
                },
                {
                    id: 'HQBY9mCWvEU',
                    title: 'शुरुआती लोगों के लिए रसायन विज्ञान',
                    description: 'परमाणु, अणु और अभिक्रियाओं सहित बुनियादी रसायन विज्ञान अवधारणाओं को सीखें।'
                },
                {
                    id: 'iKOqIDcy4UE',
                    title: 'जीव विज्ञान मूल बातें',
                    description: 'कोशिकाओं, पौधों और जानवरों सहित जीव विज्ञान की मूल बातें खोजें।'
                }
            ]
        }
    },
    gk: {
        en: {
            title: 'General Knowledge',
            videos: [
                {
                    id: 'kFZKgf6VfSc',
                    title: 'World Geography',
                    description: 'Learn about countries, capitals, and important geographical features.'
                },
                {
                    id: 'VLwaGfJymiI',
                    title: 'Indian History',
                    description: 'Discover important events and figures in Indian history.'
                },
                {
                    id: 'NiTsduRreug',
                    title: 'Current Affairs',
                    description: 'Stay updated with recent developments and current events.'
                }
            ]
        },
        te: {
            title: 'సాధారణ జ్ఞానం',
            videos: [
                {
                    id: 'kFZKgf6VfSc',
                    title: 'ప్రపంచ భూగోళ శాస్త్రం',
                    description: 'దేశాలు, రాజధానులు మరియు ముఖ్యమైన భౌగోళిక లక్షణాల గురించి తెలుసుకోండి.'
                },
                {
                    id: 'VLwaGfJymiI',
                    title: 'భారతీయ చరిత్ర',
                    description: 'భారతీయ చరిత్రలో ముఖ్యమైన సంఘటనలు మరియు వ్యక్తులను కనుగొనండి.'
                },
                {
                    id: 'NiTsduRreug',
                    title: 'ప్రస్తుత వ్యవహారాలు',
                    description: 'ఇటీవలి పరిణామాలు మరియు ప్రస్తుత సంఘటనలతో అప్‌డేట్‌గా ఉండండి.'
                }
            ]
        },
        hi: {
            title: 'सामान्य ज्ञान',
            videos: [
                {
                    id: 'kFZKgf6VfSc',
                    title: 'विश्व भूगोल',
                    description: 'देशों, राजधानियों और महत्वपूर्ण भौगोलिक विशेषताओं के बारे में जानें।'
                },
                {
                    id: 'VLwaGfJymiI',
                    title: 'भारतीय इतिहास',
                    description: 'भारतीय इतिहास में महत्वपूर्ण घटनाओं और व्यक्तियों की खोज करें।'
                },
                {
                    id: 'NiTsduRreug',
                    title: 'समसामयिक घटनाएं',
                    description: 'हाल के विकास और वर्तमान घटनाओं के साथ अपडेट रहें।'
                }
            ]
        }
    }
};

// Global variables
let currentLanguage = 'en';
let mediaRecorder;
let audioChunks = [];
let isRecording = false;
let recordedAudio;

// Initialize the website
document.addEventListener('DOMContentLoaded', function() {
    initializeLanguage();
    setupEventListeners();
    setupAudioRecording();
});

// Language functions
function changeLanguage(lang) {
    currentLanguage = lang;
    
    // Update language buttons
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // Update all translated elements
    updateTranslations();
    
    // Update HTML lang attribute
    document.documentElement.lang = lang;
}

function updateTranslations() {
    const elements = document.querySelectorAll('[data-translate]');
    elements.forEach(element => {
        const key = element.getAttribute('data-translate');
        if (translations[currentLanguage] && translations[currentLanguage][key]) {
            element.textContent = translations[currentLanguage][key];
        }
    });
    
    // Update placeholders
    const placeholderElements = document.querySelectorAll('[data-translate-placeholder]');
    placeholderElements.forEach(element => {
        const key = element.getAttribute('data-translate-placeholder');
        if (translations[currentLanguage] && translations[currentLanguage][key]) {
            element.placeholder = translations[currentLanguage][key];
        }
    });
}

function initializeLanguage() {
    updateTranslations();
}

// Navigation functions
function scrollToSection(sectionId) {
    const section = document.getElementById(sectionId);
    if (section) {
        section.scrollIntoView({ behavior: 'smooth' });
    }
}

function setupEventListeners() {
    // Mobile menu toggle
    const hamburger = document.querySelector('.hamburger');
    const navMenu = document.querySelector('.nav-menu');
    
    if (hamburger) {
        hamburger.addEventListener('click', function() {
            navMenu.classList.toggle('active');
        });
    }
    
    // Close mobile menu when clicking on a link
    document.querySelectorAll('.nav-link').forEach(link => {
        link.addEventListener('click', function() {
            if (navMenu) {
                navMenu.classList.remove('active');
            }
        });
    });
    
    // Form submissions
    const contactForm = document.querySelector('.contact-form');
    if (contactForm) {
        contactForm.addEventListener('submit', handleContactForm);
    }
    
    const authForms = document.querySelectorAll('.auth-form');
    authForms.forEach(form => {
        form.addEventListener('submit', handleAuthForm);
    });
    
    // Smooth scroll for navigation links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
}

// Modal functions
function openModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.style.display = 'block';
        document.body.style.overflow = 'hidden';
    }
}

function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
}

function switchModal(currentModalId, targetModalId) {
    closeModal(currentModalId);
    openModal(targetModalId);
}

// Subject functions
function openSubject(subjectKey) {
    const modal = document.getElementById('subjectModal');
    const title = document.getElementById('subjectTitle');
    const content = document.getElementById('subjectContent');
    
    if (modal && title && content) {
        const subjectData = subjectContent[subjectKey][currentLanguage];
        
        title.textContent = subjectData.title;
        
        // Create video list
        let videoHTML = '<div class="video-list">';
        subjectData.videos.forEach(video => {
            videoHTML += `
                <div class="video-item">
                    <iframe src="https://www.youtube.com/embed/${video.id}" 
                            frameborder="0" 
                            allowfullscreen>
                    </iframe>
                    <h4>${video.title}</h4>
                    <p>${video.description}</p>
                </div>
            `;
        });
        videoHTML += '</div>';
        
        content.innerHTML = videoHTML;
        openModal('subjectModal');
    }
}

// Audio recording functions
function setupAudioRecording() {
    const recordBtn = document.getElementById('recordBtn');
    const stopBtn = document.getElementById('stopBtn');
    const playBtn = document.getElementById('playBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const micIcon = document.getElementById('micIcon');
    
    if (recordBtn) {
        recordBtn.addEventListener('click', startRecording);
    }
    if (stopBtn) {
        stopBtn.addEventListener('click', stopRecording);
    }
    if (playBtn) {
        playBtn.addEventListener('click', playRecording);
    }
    if (downloadBtn) {
        downloadBtn.addEventListener('click', downloadRecording);
    }
    if (micIcon) {
        micIcon.addEventListener('click', toggleRecording);
    }
}

function toggleRecording() {
    if (isRecording) {
        stopRecording();
    } else {
        startRecording();
    }
}

async function startRecording() {
    try {
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        mediaRecorder = new MediaRecorder(stream);
        audioChunks = [];
        
        mediaRecorder.ondataavailable = event => {
            audioChunks.push(event.data);
        };
        
        mediaRecorder.onstop = () => {
            const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
            recordedAudio = audioBlob;
            const audioUrl = URL.createObjectURL(audioBlob);
            
            // Enable play and download buttons
            document.getElementById('playBtn').disabled = false;
            document.getElementById('downloadBtn').disabled = false;
            
            updateRecordingStatus('Recording completed');
        };
        
        mediaRecorder.start();
        isRecording = true;
        
        // Update UI
        document.getElementById('recordBtn').disabled = true;
        document.getElementById('stopBtn').disabled = false;
        document.getElementById('micIcon').classList.add('recording');
        updateRecordingStatus('Recording...');
        
    } catch (error) {
        console.error('Error starting recording:', error);
        updateRecordingStatus('Error: Could not access microphone');
    }
}

function stopRecording() {
    if (mediaRecorder && isRecording) {
        mediaRecorder.stop();
        isRecording = false;
        
        // Stop all tracks
        mediaRecorder.stream.getTracks().forEach(track => track.stop());
        
        // Update UI
        document.getElementById('recordBtn').disabled = false;
        document.getElementById('stopBtn').disabled = true;
        document.getElementById('micIcon').classList.remove('recording');
    }
}

function playRecording() {
    if (recordedAudio) {
        const audioUrl = URL.createObjectURL(recordedAudio);
        const audio = new Audio(audioUrl);
        audio.play();
        updateRecordingStatus('Playing recording...');
        
        audio.onended = () => {
            updateRecordingStatus('Playback completed');
        };
    }
}

function downloadRecording() {
    if (recordedAudio) {
        const audioUrl = URL.createObjectURL(recordedAudio);
        const link = document.createElement('a');
        link.href = audioUrl;
        link.download = `audio-signature-${Date.now()}.wav`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        updateRecordingStatus('Download started');
    }
}

function updateRecordingStatus(message) {
    const statusElement = document.getElementById('recordingStatus');
    if (statusElement) {
        statusElement.textContent = message;
    }
}

// Form handling functions
function handleContactForm(e) {
    e.preventDefault();
    const formData = new FormData(e.target);
    
    // Simulate form submission
    alert('Thank you for your message! We will get back to you soon.');
    e.target.reset();
}

function handleAuthForm(e) {
    e.preventDefault();
    const formData = new FormData(e.target);
    
    // Simulate authentication
    alert('Authentication successful! Welcome to Gramshiksha.');
    
    // Close the modal
    const modal = e.target.closest('.modal');
    if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
}

// Close modal when clicking outside
window.addEventListener('click', function(e) {
    const modals = document.querySelectorAll('.modal');
    modals.forEach(modal => {
        if (e.target === modal) {
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }
    });
});

// Intersection Observer for animations
const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
};

const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('fade-in');
        }
    });
}, observerOptions);

// Observe elements for animation
document.addEventListener('DOMContentLoaded', () => {
    const elementsToAnimate = document.querySelectorAll('.subject-card, .video-card, .contact-item');
    elementsToAnimate.forEach(el => observer.observe(el));
});